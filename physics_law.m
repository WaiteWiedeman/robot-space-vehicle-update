function F = physics_law(Y,sysParams)
    sz = size(Y);
    F = zeros(sz(2),5);

    xv = Y(1,:); % vehicle x position
    yv = Y(2,:); % vehicle y position
    alv = Y(3,:); % vehicle pitch angle
    th1 = Y(4,:); % link 1 position
    th2 = Y(5,:); % link 2 position
    xvd = Y(6,:); % vehicle x velocity
    yvd = Y(7,:); % vehicle y velocity
    alvd = Y(8,:); % vehicle pitch velocity
    th1d = Y(9,:); % link 1 velocity
    th2d = Y(10,:); % link 2 velocity
    xvdd = Y(11,:); % vehicle x acceleration
    yvdd = Y(12,:); % vehicle y acceleration
    alvdd = Y(13,:); % vehicle pitch acceleration
    th1dd = Y(14,:); % link 1 acceleration
    th2dd = Y(15,:); % link 2 acceleration

    % system parameters
    b1 = sysParams.b1;
    b2 = sysParams.b2;
    L1 = sysParams.L1;
    L2 = sysParams.L2;
    G = sysParams.G;
    M0 = sysParams.M0;
    M1 = sysParams.M1;
    M2 = sysParams.M2;
    l1 = L1/2;
    l2 = L2/2;
    I0 = (1/12)*M0*(b1^2+b2^2);
    I1 = (1/12)*M1*L1^2;
    I2 = (1/12)*M2*L2^2;

    F(:,1) = (M0+M1+M2).*xvdd + (-((M1*l1+L1*M2)*sin(alv+th1)+b1/2*(M1+M2)*sin(alv)+M2*l2*sin(alv+th1+th2))).*alvdd ...
        + (-((M1*l1+L1*M2)*sin(alv+th1)+M2*l2*sin(alv+th1+th2))).*th1dd + (-M2*l2*sin(alv+th1+th2)).*th2dd ...
        + (-((M1*l1+M2*L1)*alvd.*cos(alv+th1)+b1/2*(M1+M2)*alvd.*cos(alv)+M2*l2*alvd.*cos(alv+th1+th2))).*alvd ... 
        + (-((M1*l1+M2*L1)*cos(alv+th1).*(2*alvd+th1d)+M2*l2*cos(alv+th1+th2).*(2*alvd+th1d))).*th1d ...
        + (-M2*l2*cos(alv+th1+th2).*(2*alvd+2*th1d+th2d)).*th2d; 
    F(:,2) = (M0+M1+M2).*yvdd + (((M1*l1+L1*M2)*cos(alv+th1)+b1/2*(M1+M2)*cos(alv)+M2*l2*cos(alv+th1+th2))).*alvdd ...
        + (((M1*l1+L1*M2)*cos(alv+th1)+M2*l2*cos(alv+th1+th2))).*th1dd + (M2*l2*cos(alv+th1+th2)).*th2dd ...
        + (-(b1/2*(M1+M2)*alvd.*sin(alv)+(M1*l1+M2*L1)*alvd.*sin(alv+th1)+M2*l2*alvd.*sin(alv+th1+th2))).*alvd ...
        + (-((M1*l1+M2*L1)*sin(alv+th1).*(2*alvd+th1d)+M2*l2*sin(alv+th1+th2).*(2*alvd+th1d))).*th1d ...
        + (-M2*l2*sin(alv+th1+th2).*(2*alvd+2*th1d+th2d)).*th2d + (M0+M1+M2)*G;
    F(:,3) = (-((L1*M2+l1*M1)*sin(alv+th1)+b1/2*(M1+M2)*sin(alv)+l2*M2*sin(alv+th1+th2))).*xvdd ...
        + (((L1*M2+l1*M1)*cos(alv+th1)+b1/2*(M1+M2)*cos(alv)+l2*M2*cos(alv+th1+th2))).*yvdd ...
        + ((I0+l1^2*M1+b1^2/4*(M1+M2)*cos(alv).^2+b1^2/4*(M1+M2)*sin(alv).^2+(l2^2+L1^2)*M2 ...
        + b1*(L1*M2+l1*M1)*cos(alv+th1).*cos(alv)+b1*(L1*M2+l1*M1)*sin(alv+th1).*sin(alv) ...
        + 2*L1*l2*M2*cos(th2)+b1*l2*M2*cos(alv+th1+th2).*cos(alv)+b1*l2*M2*sin(alv+th1+th2).*sin(alv))).*alvdd ...
        + (((l2^2+L1^2)*M2+l1^2*M1+b1/2*l2*M2*sin(alv+th1+th2).*sin(alv)+b1/2*(L1*M2+l1*M1)*cos(alv+th1).*cos(alv)...
        + b1/2*(L1*M2+l1*M1)*sin(alv+th1).*sin(alv)+2*L1*l2*M2*cos(th2)+b1/2*l2*M2*cos(alv+th1+th2).*cos(alv))).*th1dd ...
        + ((l2^2*M2+b1/2*l2*M2*sin(alv+th1+th2).*sin(alv)+L1*l2*M2*cos(th2)+b1/2*l2*M2*cos(alv+th1+th2).*cos(alv))).*th2dd ...
        + (((b1^2/4-b1^2/4)*(M1+M2)*alvd.*cos(alv).*sin(alv)+(b1/2-b1/2)*l2*M2*alvd.*sin(2*alv+th1+th2) ...
        + (b1/2-b1/2)*(M1*l1+M2*L1)*alvd.*sin(2*alv+th1))).*alvd ...
        + ((b1/2*l2*M2*(2*alvd+th1d).*cos(alv+th1+th2).*sin(alv)-b1/2*l2*M2*(2*alvd+th1d).*sin(alv+th1+th2).*cos(alv) ...
        + L1*b1/2*M2*(2*alvd+th1d).*cos(alv+th1).*sin(alv)-L1*b1/2*M2*(2*alvd+th1d).*sin(alv+th1).*cos(alv) ...
        + b1/2*l1*M1*(2*alvd+th1d).*cos(alv+th1).*sin(alv)-b1/2*l1*M1*(2*alvd+th1d).*sin(alv+th1).*cos(alv))).*th1d ...
        + ((L1*l2*M2*th2d.*cos(2*(alv+th1)+th2)+b1/2*l2*M2*(th2d+2*th1d+2*alvd).*cos(alv+th1+th2).*sin(alv) ...
        -b1/2*l2*M2*(th2d+2*th1d+2*alvd).*sin(alv+th1+th2).*cos(alv)+2*L1*l2*M2*(th1d+alvd).*cos(alv+th1+th2).*sin(alv+th1) ...
        -2*L1*l2*M2*(th1d+alvd).*sin(alv+th1+th2).*cos(alv+th1))).*th2d + (((L1*M2+l1*M1)*cos(alv+th1)+b1/2*(M1+M2)*cos(alv)+l2*M2*cos(alv+th1+th2)))*G;
    F(:,4) = (-((L1*M2+l1*M1)*sin(alv+th1)+l2*M2*sin(alv+th1+th2))).*xvdd + (((L1*M2+l1*M1)*cos(alv+th1)+l2*M2*cos(alv+th1+th2))).*yvdd ... 
        + (((l2^2+L1^2)*M2+l1^2*M1+(b1/4-b1/4)*l2*M2*cos(2*alv+th1+th2)+(b1/4+b1/4)*l2*M2*cos(th1+th2) ...
        +(b1/4+b1/4)*L1*M2*cos(th1)+2*L1*l2*M2*cos(th2)+(b1/4+b1/4)*l1*M1*cos(th1) ...
        +(b1/4-b1/4)*L1*M2*cos(2*alv+th1)+(b1/4-b1/4)*l1*M1*cos(2*alv+th1))).*alvdd ...
        + ((I1+(l2^2+L1^2)*M2+l1^2*M1+2*L1*l2*M2*cos(th2))).*th1dd + ((l2^2*M2+L1*l2*M2*cos(th2))).*th2dd ...
        + (((b1/4+b1/4)*l2*M2*alvd.*sin(th1+th2)+(b1/4+b1/4)*(M1*l1+M2*L1)*alvd.*sin(th1)...
              +(b1/4-b1/4)*(M1*l1+M2*L1)*alvd.*sin(2*alv+th1)+(b1/4-b1/4)*l2*M2*alvd.*sin(2*alv+th1+th2))).*alvd ...
        + (-L1*l2*M2*sin(th2).*(2*alvd+2*th1d+th2d)).*th2d + (((L1*M2+l1*M1)*cos(alv+th1)+l2*M2*cos(alv+th1+th2)))*G;
    F(:,5) = (-l2*M2*sin(alv+th1+th2)).*xvdd + (l2*M2*cos(alv+th1+th2)).*yvdd ...
        + (l2^2*M2+(b1/4-b1/4)*l2*M2*cos(2*alv+th1+th2)+(b1/4+b1/4)*l2*M2*cos(th1+th2)+L1*l2*M2*cos(th2)).*alvdd ...
        + ((l2^2*M2+L1*l2*M2*cos(th2))).*th1dd + ((I2+l2^2*M2)).*th2dd ... 
        + (((b1/4+b1/4)*l2*M2*alvd.*sin(th1+th2)+L1*l2*M2*alvd.*sin(th2)+(b1/4-b1/4)*l2*M2*alvd.*sin(2*alv+th1+th2))).*alvd ...
        + ((L1*l2*M2*sin(th2).*(2*alvd+th1d))).*th1d + (l2*M2*cos(alv+th1+th2))*G;
end